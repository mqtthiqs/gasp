\documentclass[ignorenonframetext,red]{beamer}

\usepackage{ucs}
\usepackage{mathpartir}
\usepackage{amsfonts,amsmath,amscd}
\usepackage{stmaryrd}
\usepackage[utf8x]{inputenc}
\usepackage[protrusion=true,expansion=true]{microtype}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{natbib}


\date{\\[1em]January 2011\\[0.5em]
\small Groupe de travail théorie des types et réalisabilité}

\title{A logical framework for incremental type-checking}

\author[Matthias Puech \& Yann Régis-Gianas] {
  Matthias Puech\inst{1,2} \and Yann Régis-Gianas\inst{2}
}

\institute {
  \inst 1 {Dept. of Computer Science, University of Bologna} \and
  \inst 2 {University Paris 7, CNRS, and INRIA, PPS, team ${\pi}r^2$}
}

\setbeamertemplate{footline}[frame number]
\setbeamertemplate{navigation symbols}{}

\usefonttheme{serif}

% Grammars
\newcommand\gor{\ |\ }
\newcommand\gequal{\ ::=\ }

% Terms
\newcommand\postbinder{\cdot}
\newcommand\prd[2]{\ensuremath\Pi{#1}^{#2}\postbinder}
\newcommand\prdi[1]{\ensuremath\forall{#1}\postbinder}
\newcommand\srt[1]{\ensuremath\mathsf{#1}}
\newcommand\app[1]{{#1}\ }
\newcommand\tlam[2]{\ensuremath\lambda{#1}^{#2}\postbinder}
\newcommand\ulam[1]{\ensuremath\lambda{#1}\postbinder}
\newcommand\letb[2]{\ensuremath\textsf{let}\ {#1}={#2}\ \textsf{in}\ }
\newcommand\lam{\tlam}

% Sequent-like application
\newcommand\lapp[2]{{#1}[{#2}]}
\newcommand\laapp[3]{{#1}[{#2}]:{#3}}
\newcommand\lnil{\cdot}
\newcommand\lcons[2]{{#1};{#2}}
\newcommand\lncons[3]{{#1}={#2};{#3}}

%Environments
\newcommand\enil\cdot
\newcommand\eent[1]{[{#1}]}
\newcommand\econs[2]{{#1}\eent{#2}}
\newcommand\esing[1]{\econs{}{#1}}

% Term operations
\newcommand\subst[2]{\{{#1}/{#2}\}}
\newcommand\repl[2]{\subst{#1}{{#2}}}

% Judgements
\newcommand\jlangt[4]{{#2}\vdash_{\mathrm{#1}}{#3}:{#4}}
\newcommand\jlangA[3]{{#2}\vdash_{\mathrm{#1}}{#3}\mathsf{\ type}}
\newcommand\jlangK[3]{{#2}\vdash_{\mathrm{#1}}{#3}\mathsf{\ kind}}

\newcommand\jlft[3]{\jlangt{LF}{#1}{#2}{#3}}
\newcommand\jlfA[2]{\jlangA{LF}{#1}{#2}}
\newcommand\jlfK[2]{\jlangK{LF}{#1}{#2}}

\newcommand\jxlft[3]{\jlangt{XLF}{#1}{#2}{#3}}
\newcommand\jxlfA[2]{\jlangA{XLF}{#1}{#2}}
\newcommand\jxlfK[2]{\jlangK{XLF}{#1}{#2}}

\newcommand\jnlft[3]{{#1}\vdash{#2}:{#3}}
\newcommand\jnlfA[2]{{#1}\vdash{#2}\ \mathsf{type}}
\newcommand\jnlfK[1]{{#1}\ \mathsf{kind}}

% simple judgements with no environments (NLF)
\newcommand\jwf[1]{{#1}\ \mathsf{wf}}

% Animations
\newcommand\alta[4]{\alt<-#1>{#3}{\only<#2>\alert{#4}}}
\newcommand\uncovera[2]{\uncover<#1->{\only<#1>\alert{#2}}}
\newcommand\onlya[2]{\only<#1->{\alert<#1>{#2}}}

% Various
\newcommand\gray[1]{\textcolor{gray}{#1}}
\newcommand\cit[1]{[\textcolor{blue}{#1}]}
\newcommand\To{\Rightarrow}
\newcommand\too{\longrightarrow}
\newcommand\Too{\Longrightarrow}

\begin{document}

\frame\titlepage

\section{Introduction}

\section{The language}

\begin{frame}{From LF to XLF}
  \begin{overlayarea}{0em}{15em}
    \begin{align*}
      K &\gequal \prd x A K \gor \srt * \\
      A &\gequal \prd x A A \gor \alta{1}{2}{\app A t}
      {\alta{2}{3}{\lapp A l}{\laapp A l K}} \gor \alta{1}{2}{a}
      {\alta{2}{3}{\lapp a l}{\laapp a l K}} \\
      t &\gequal \lam x A t \gor \letb x t t \gor \alta{1}{2}{\app t
        t} {\alta{2}{3}{\lapp t l}{\laapp t l A}} \gor \alta{1}{2}{x}
      {\alta{2}{3}{\lapp x l}{\laapp x l A}} \gor \alta{1}{2}{c}
      {\alta{2}{3}{\lapp c l}{\laapp c l A}} \\
      \only<2->{l &\gequal \lnil \gor
        \alta{5}{6}{\lcons t l}{\lncons x t l}\\}
      \Gamma &\gequal \enil \gor \econs\Gamma{x:A} \gor \econs\Gamma{x=t} \\
      \Sigma &\gequal \enil \gor \econs\Sigma{c:A} \gor \econs\Sigma{a:K} \\
    \end{align*}
  \end{overlayarea}

  \begin{overlayarea}{\textwidth}{\textheight}
    \uncover<4->{ \alt<-6>{
        \begin{mathpar}
          \infer { \Gamma\vdash t : A \and \alta{4}{5}{\Gamma,B\subst
              x t}{\econs\Gamma{x=t}, B}\vdash l : C} {\Gamma,\prd x A
            B \vdash \alta{5}{6}{\lcons t l}{\lncons x t l} : C}
        \end{mathpar}
      }{
        \begin{align*}
          FV(\laapp t l A) &= FV(t) \cup FV(l) \cup (FV(A) - FV(l)) \\
          FV(\lncons x t l) &= FV(t) \cup (FV(l) - \{x\}) \\
          FV(\lnil) &= \emptyset \\
        \end{align*}
      } }
  \end{overlayarea}
  \pause\pause\pause\pause\pause\pause
\end{frame}

\begin{frame}{XLF: Properties}
  \begin{itemize}
  \item LJ-style application
  \item type annotation on application spine
  \item named arguments
  \end{itemize}
  \begin{lemma}[Conservativity]
    \begin{itemize}
    \item $\jlfK \Gamma K \quad\text{iff}\quad \jxlfK {|\Gamma|} {|K|}$
    \item $\jlfA \Gamma A \quad\text{iff}\quad \jxlfA {|\Gamma|} {|A|}$
    \item $\jlft \Gamma t A \quad\text{iff}\quad \jxlft {|\Gamma|} {|t|} {|A|}$
    \end{itemize}
  \end{lemma}
\end{frame}

\begin{frame}{From XLF to NLF}
  \begin{overlayarea}{0em}{16em}
    \begin{align*}
      K &\gequal \alta{9}{10}{\prd x A K \gor \alta{1}{2}{\srt
          *}{h_K}}{\Gamma\vdash h_k} \\
      \only<2->{\alert<2>{h_K}}\only<2->{&\alert<2>{\gequal \srt *} \\}
      A &\gequal \alta{8}{9}{ \prd x A A \gor \alta{2}{3}{\laapp A l K
          \gor \laapp a l K}{h_A}}
      {\Gamma\vdash h_A}\\
      \only<3->{\alert<3>{h_A} &\alert<3>{\gequal\laapp A l {\alta{4}{5} K
          {h_K}} \gor
        \laapp a l {\alta{4}{5} K {h_K}}} \\}
      t &\gequal \alta{7}{8}{\lam x A t \gor \letb x t t \gor
        \alta{3}{4}{\laapp t l A \gor \laapp x l A \gor
          \laapp c l A}{h_t}}{\Gamma\vdash h_t} \\
      \only<4->{\alert<4>{h_t}&\alert<4>{\gequal \laapp t l
        {\alta{5}{6}{A}{h_A}} \gor \laapp x l {\alta{5}{6}{A}{h_A}}
        \gor
        \laapp c l {\alta{5}{6}{A}{h_A}}}\\}
      l &\gequal \alta{10}{11}{\lnil \gor
        \lncons x t l}{\Gamma} \\
      \alta{11}{12}\Gamma\Gamma &\alta{11}{12} {\gequal \enil \gor
        \econs\Gamma{x:A} \gor \econs\Gamma{x=t}}
      {\ :\ x \mapsto (\eent{x:A} \gor \eent{x=t})} \\
      \Sigma &\gequal \enil \gor \econs\Sigma{c:A} \gor \econs\Sigma{a:K} \\
    \end{align*}
  \end{overlayarea}
  \uncover<7->{
    \[
    \laapp t l {\prd x A B}\quad\too_\eta\quad \lam x A ({\laapp t
      {x;l} B})
    \]
  }
  \pause\pause\pause\pause\pause\pause\pause\pause\pause\pause\pause
\end{frame}

\begin{frame}{NLF}
  \begin{block}{Syntax}
    \begin{align*}
      \\[-3em]
      K &\gequal \jnlfK\Gamma \\
      A &\gequal \jnlfA\Gamma{h_A} \\
      h_A &\gequal \app a \Gamma \\
      t &\gequal \jnlft\Gamma{h_t}{h_A} \\
      h_t &\gequal \app t\Gamma \gor
      \app x\Gamma \gor \app c\Gamma \\
      \Gamma &\quad :\quad x \mapsto (\eent{x:a} \gor \eent{x=t})
    \end{align*}
  \end{block}
  \begin{overlayarea}{\textwidth}{\textwidth}
    \begin{block}{Judgements}
      \begin{itemize}
      \item $\alt<-1>{\jnlfK\Gamma}{\alt<-2> K {\jwf K}}$
      \item $\alt<-1>{\jnlfA\Gamma{h_A}}{\alt<-2> A {\jwf A}}$
      \item $\alt<-1>{\jnlft\Gamma{h_t}{h_A}}{\alt<-2> t {\jwf t}}$
      \end{itemize}
    \end{block}
  \end{overlayarea}
  \pause\pause
\end{frame}

\begin{frame}{NLF}
  \begin{block}{Notations}
    \begin{itemize}
    \item ``$A$'' for ``$\jnlfA{}{A}$''
    \item ``$a$'' for ``$\app a \emptyset$''
    \end{itemize}
  \end{block}
  \begin{example}
    \begin{itemize}
    \item $\jnlft
      {\econs
        {\eent{f:\jnlfA{\eent{a:A}}{B}}}
        {x:A}}
      {\app f {\esing{a=x}}}
      {B}$
    \end{itemize}
  \end{example}
\end{frame}

\begin{frame}{NLF: Properties}
  \begin{itemize}
  \item terms in $\eta$-expanded form
  \item terms are pairs (binders, head)
  \item first-class, abstract environments (telescopes)
  \item first-class judgements
  \end{itemize}
\end{frame}
\end{document}